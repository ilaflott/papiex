name: compile_papiex                                                                                                                                                               
                                                                                                                                                                                        
on:                                                                                                                                                                                     
  push                                                                                                                                                                                  
                                                                                                                                                                                  
# cancel running jobs if theres a newer push                                                                                                                                            
concurrency:                                                                                                                                                                            
  group: ${{ github.workflow }}-${{ github.ref }}                                                                                                                                       
  cancel-in-progress: true                                                                                                                                                              
                                                                                                                                                                                        
                                                                                                                                                                                        
jobs:                                                                                                                                                                                   
  build-linux:                                                                                                                                                                          
    runs-on: ubuntu-latest                                                                                                                                                              
                                                                                                                                                                                        
    #service:                                                                                                                                                                           
    #  - postgres:latest                                                                                                                                                                
                                                                                                                                                                                        
    container:                                                                                                                                                                          
      image: rockylinux:8                                                                                                                                                               
      options: --privileged                                                                                                                                                         
                                                                                                                                                                                        
    steps:                                                                                                                                                                              
      - uses: actions/checkout@v4                                                                                                                                                       
      - name: build with yum install and update                                                                                                                                                    
        run: |                                                                                                                                                                          
          yum update -y                                                                                                                                                                 
          yum install -y gcc make file findutils

      - name: compile papiex                                                                                                                                               
        run: |                                                                                                                                                                          
          mkdir /build
          make OS_TARGET=rocky-8 distclean install dist dist-test                                                                                                                       

